(function(a){a.fn.bjqs=function(v){var l={width:700,height:300,animtype:"fade",animduration:450,animspeed:4000,automatic:true,showcontrols:true,centercontrols:true,nexttext:"Next",prevtext:"Prev",showmarkers:true,centermarkers:true,keyboardnav:true,hoverpause:true,usecaptions:true,randomstart:false,responsive:false};var E=a.extend({},l,v);var z=this,D=z.find("ul.bjqs"),C=D.children("li"),q=null,u=null,m=null,F=null,j=null,i=null,n=null,A=null;var h={slidecount:C.length,animating:false,paused:false,currentslide:1,nextslide:0,currentindex:0,nextindex:0,interval:null};var e={width:null,height:null,ratio:null};var s={fwd:"forward",prev:"previous"};var y=function(){C.addClass("bjqs-slide");if(E.responsive){b()}else{d()}if(h.slidecount>1){if(E.randomstart){g()}if(E.showcontrols){w()}if(E.showmarkers){c()}if(E.keyboardnav){r()}if(E.hoverpause&&E.automatic){p()}if(E.animtype==="slide"){B()}}else{E.automatic=false}if(E.usecaptions){f()}if(E.animtype==="slide"&&!E.randomstart){h.currentindex=1;h.currentslide=2}D.show();C.eq(h.currentindex).show();if(E.automatic){h.interval=setInterval(function(){x(s.fwd,false)},E.animspeed)}};var b=function(){e.width=z.outerWidth();e.ratio=e.width/E.width,e.height=E.height*e.ratio;if(E.animtype==="fade"){C.css({height:E.height,width:"100%"});C.children("img").css({height:E.height,width:"100%"});D.css({height:E.height,width:"100%"});z.css({height:E.height,"max-width":E.width,position:"relative"});if(e.width<E.width){C.css({height:e.height});C.children("img").css({height:e.height});D.css({height:e.height});z.css({height:e.height})}a(window).resize(function(){e.width=z.outerWidth();e.ratio=e.width/E.width,e.height=E.height*e.ratio;C.css({height:e.height});C.children("img").css({height:e.height});D.css({height:e.height});z.css({height:e.height})})}if(E.animtype==="slide"){C.css({height:E.height,width:E.width});C.children("img").css({height:E.height,width:E.width});D.css({height:E.height,width:E.width*E.slidecount});z.css({height:E.height,"max-width":E.width,position:"relative"});if(e.width<E.width){C.css({height:e.height,width:e.width});C.children("img").css({height:e.height,width:e.width});D.css({height:e.height});z.css({height:e.height})}a(window).resize(function(){e.width=z.outerWidth(),e.ratio=e.width/E.width,e.height=E.height*e.ratio;C.css({height:e.height,width:e.width});C.children("img").css({height:e.height,width:e.width});D.css({height:e.height,width:e.width*E.slidecount});z.css({height:e.height});i.css({height:e.height,width:e.width});t(function(){x(false,h.currentslide)},200,"some unique string")})}};var t=(function(){var o={};return function(I,G,H){if(!H){H="Don't call this twice without a uniqueId"}if(o[H]){clearTimeout(o[H])}o[H]=setTimeout(I,G)}})();var d=function(){C.css({height:E.height,width:E.width});D.css({height:E.height,width:E.width});z.css({height:E.height,width:E.width,position:"relative"})};var B=function(){n=C.eq(0).clone();A=C.eq(h.slidecount-1).clone();n.attr({"data-clone":"last","data-slide":0}).appendTo(D).show();A.attr({"data-clone":"first","data-slide":0}).prependTo(D).show();C=D.children("li");h.slidecount=C.length;i=a('<div class="bjqs-wrapper"></div>');if(E.responsive&&(e.width<E.width)){i.css({width:e.width,height:e.height,overflow:"hidden",position:"relative"});D.css({width:e.width*(h.slidecount+2),left:-e.width*h.currentslide})}else{i.css({width:E.width,height:E.height,overflow:"hidden",position:"relative"});D.css({width:E.width*(h.slidecount+2),left:-E.width*h.currentslide})}C.css({"float":"left",position:"relative",display:"list-item"});i.prependTo(z);D.appendTo(i)};var w=function(){q=a('<ul class="bjqs-controls"></ul>');u=a('<li class="bjqs-next"><a href="#" data-direction="'+s.fwd+'">'+E.nexttext+"</a></li>");m=a('<li class="bjqs-prev"><a href="#" data-direction="'+s.prev+'">'+E.prevtext+"</a></li>");q.on("click","a",function(J){J.preventDefault();var I=a(this).attr("data-direction");if(!h.animating){if(I===s.fwd){x(s.fwd,false)}if(I===s.prev){x(s.prev,false)}}});m.appendTo(q);u.appendTo(q);q.appendTo(z);if(E.centercontrols){q.addClass("v-centered");var H=(z.height()-u.children("a").outerHeight())/2,o=(H/E.height)*100,G=o+"%";u.find("a").css("top",G);m.find("a").css("top",G)}};var c=function(){F=a('<ol class="bjqs-markers"></ol>');a.each(C,function(I,G){var K=I+1,J=I+1;if(E.animtype==="slide"){J=I+2}var H=a('<li><a href="#">'+K+"</a></li>");if(K===h.currentslide){H.addClass("active-marker")}H.on("click","a",function(L){L.preventDefault();if(!h.animating&&h.currentslide!==J){x(false,J)}});H.appendTo(F)});F.appendTo(z);j=F.find("li");if(E.centermarkers){F.addClass("h-centered");var o=(E.width-F.width())/2;F.css("left",o)}};var r=function(){a(document).keyup(function(o){if(!h.paused){clearInterval(h.interval);h.paused=true}if(!h.animating){if(o.keyCode===39){o.preventDefault();x(s.fwd,false)}else{if(o.keyCode===37){o.preventDefault();x(s.prev,false)}}}if(h.paused&&E.automatic){h.interval=setInterval(function(){x(s.fwd)},E.animspeed);h.paused=false}})};var p=function(){z.hover(function(){if(!h.paused){clearInterval(h.interval);h.paused=true}},function(){if(h.paused){h.interval=setInterval(function(){x(s.fwd,false)},E.animspeed);h.paused=false}})};var f=function(){a.each(C,function(H,o){var G=a(o).children("img:first-child").attr("title");if(!G){G=a(o).children("a").find("img:first-child").attr("title")}if(G){G=a('<p class="bjqs-caption">'+G+"</p>");G.appendTo(a(o))}})};var g=function(){var o=Math.floor(Math.random()*h.slidecount)+1;h.currentslide=o;h.currentindex=o-1};var k=function(o){if(o===s.fwd){if(C.eq(h.currentindex).next().length){h.nextindex=h.currentindex+1;h.nextslide=h.currentslide+1}else{h.nextindex=0;h.nextslide=1}}else{if(C.eq(h.currentindex).prev().length){h.nextindex=h.currentindex-1;h.nextslide=h.currentslide-1}else{h.nextindex=h.slidecount-1;h.nextslide=h.slidecount}}};var x=function(H,o){if(!h.animating){h.animating=true;if(o){h.nextslide=o;h.nextindex=o-1}else{k(H)}if(E.animtype==="fade"){if(E.showmarkers){j.removeClass("active-marker");j.eq(h.nextindex).addClass("active-marker")}C.eq(h.currentindex).fadeOut(E.animduration);C.eq(h.nextindex).fadeIn(E.animduration,function(){h.animating=false;h.currentslide=h.nextslide;h.currentindex=h.nextindex})}if(E.animtype==="slide"){if(E.showmarkers){var G=h.nextindex-1;if(G===h.slidecount-2){G=0}else{if(G===-1){G=h.slidecount-3}}j.removeClass("active-marker");j.eq(G).addClass("active-marker")}if(E.responsive&&(e.width<E.width)){h.slidewidth=e.width}else{h.slidewidth=E.width}D.animate({left:-h.nextindex*h.slidewidth},E.animduration,function(){h.currentslide=h.nextslide;h.currentindex=h.nextindex;if(C.eq(h.currentindex).attr("data-clone")==="last"){D.css({left:-h.slidewidth});h.currentslide=2;h.currentindex=1}else{if(C.eq(h.currentindex).attr("data-clone")==="first"){D.css({left:-h.slidewidth*(h.slidecount-2)});h.currentslide=h.slidecount-1;h.currentindex=h.slidecount-2}}h.animating=false})}}};y()}})(jQuery);